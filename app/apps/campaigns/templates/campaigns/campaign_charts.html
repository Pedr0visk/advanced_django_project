{% extends 'base.html' %}

{% block breadcrumb %}
    <!-- breadcrumb -->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://code.highcharts.com/stock/highstock.js"></script>
    <script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/stock/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/annotations.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jointjs/2.1.0/joint.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/modules/solid-gauge.js"></script>



    <div class="page-title">
        <div class="container-fluix px-5">
            <div class="page-title-wrapper-2">
                <div class="page-title-heading-2">
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block main %}
    {% if messages %}
        <ul class="messagelist">
            {% for message in messages %}
                <li class="success">{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}
    <!-- main -->
    <div class="main">
    <!-- section 2 -->
    <div class="section">
        <div class="container-fluid px-5">
            <!-- section title -->
            <div class="section-title mb-3">
                <p>Dashboard for Schema</p>
                <div>
                    <a href="{% url 'campaigns:index' campaign.pk %}" class="btn btn-sm btn-success mr-2">
                        <small>Back</small>
                    </a>
                    <a href="" class="btn btn-sm btn-warning mr-2">
                        <small>EDIT
                            <i class="fa fa-pencil-alt"></i></small>
                    </a>
                    <a href="" class="btn btn-sm btn-danger"><small>DELETE <i
                            class="fa fa-times"></i></small>
                    </a>
                </div>
            </div>
            <hr>

            <!-- section content -->
            <div class="row">
                <div class="col-6">

                    <div id="container1"></div>

                    <p>
                        <a class="btn btn-secondary" style="float: right; color: white" role="button"
                           onclick="showresults1()">View Max and Averages &#8650; </a></p>

                    <div id="result1" ; style="display: none;">
                        <div style="width: 45%;float:right;">

                            <table class="table thead-dark table-striped "
                                   style="border:1px solid black; background-color: #FFFFFF">
                                <thead class="thead-dark">
                                <h6 class="text-light bg-dark" style="text-align: center; padding: 0.5rem">Average
                                    Value Analysis</h6>
                                <tr>

                                    <th scope="col text-light"> Average PFD</th>
                                    <th scope="col text-light"> Sil/Condition</th>
                                </tr>
                                </thead>

                                <tbody>

                                <tr>

                                    <td scope="col"> {{ average.0 | stringformat:".2e" }} </td>
                                    {% if average.0  > 0.01 %}
                                        <td style="color:black;font-weight: bold;background-color: #ec3633;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            SIL 1
                                        </td>
                                    {% elif average.0 > 0.001 %}
                                        <td style="color:black;font-weight: bold;background-color: orange;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            SIL 2
                                        </td>
                                    {% else %}
                                        <td style="color:black;font-weight: bold; background-color:  lime;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            Below Sil2
                                        </td>

                                    {% endif %}
                                </tr>

                                </tbody>

                            </table>
                        </div>
                        <div style="width: 45%;float:left;">
                            <table class="table thead-dark table-striped "
                                   style="border:1px solid black; background-color: #FFFFFF">
                                <thead class="thead-dark">
                                <h6 class="text-light bg-dark" style="ext-align: center; padding: 0.5rem">Maximo
                                    Value Analysis</h6>
                                <tr>

                                    <th scope="col text-light"> Maximo PFD</th>
                                    <th scope="col text-light"> Sil/Condition</th>
                                </tr>
                                </thead>

                                <tbody>

                                <tr>

                                    <td scope="col"> {{ maxi.0 | stringformat:".2e" }} </td>
                                    {% if maxi.0  > 0.01 %}
                                        <td style="color:black;font-weight: bold;background-color: #ec3633;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            SIL 1
                                        </td>
                                    {% elif maxi.0 > 0.001 %}
                                        <td style="color:black;font-weight: bold;background-color: orange;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            SIL 2
                                        </td>
                                    {% else %}
                                        <td style="color:black;font-weight: bold; background-color:  lime;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            Under Sil2
                                        </td>

                                    {% endif %}
                                </tr>

                                </tbody>

                            </table>
                        </div>
                    </div>

                </div>


                <div class="col-6">


                    <div id="container2"></div>
                    <p>
                        <a class="btn btn-secondary" style="float: right; color: white" role="button"
                           onclick="showresults2()">View Max and Averages &#8650; </a></p>
                    <div id="result2" ; style="display: none;">
                        <div style="width: 45%;float:right;">

                            <table class="table thead-dark table-striped "
                                   style="border:1px solid black; background-color: #FFFFFF">
                                <thead class="thead-dark">
                                <h6 class="text-light bg-dark" style="text-align: center; padding: 0.5rem">Average Value
                                    Analysis</h6>
                                <tr>

                                    <th scope="col text-light"> Average PFD</th>
                                    <th scope="col text-light"> Sil/Condition</th>
                                </tr>
                                </thead>

                                <tbody>

                                <tr>

                                    <td scope="col"> {{ average.1 | stringformat:".2e" }} </td>
                                    {% if average.1  > 0.01 %}
                                        <td style="color:black;font-weight: bold;background-color: #ec3633;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            SIL 1
                                        </td>
                                    {% elif average.1 > 0.001 %}
                                        <td style="color:black;font-weight: bold;background-color: orange;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            SIL 2
                                        </td>
                                    {% else %}
                                        <td style="color:black;font-weight: bold; background-color:  lime;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            Under Sil2
                                        </td>

                                    {% endif %}
                                </tr>


                                </tbody>

                            </table>
                        </div>
                        <table class="table thead-dark table-striped "
                               style="width: 45%;border:1px solid black; background-color: #FFFFFF">
                            <thead class="thead-dark">
                            <h6 class="text-light bg-dark" style="width: 45%;text-align: center; padding: 0.5rem">Maximo
                                Value Analysis</h6>
                            <tr>

                                <th scope="col text-light"> Maximo PFD</th>
                                <th scope="col text-light"> Sil/Condition</th>
                            </tr>
                            </thead>

                            <tbody>

                            <tr>

                                <td scope="col"> {{ maxi.1 | stringformat:".2e" }} </td>
                                {% if maxi.1  > 0.01 %}
                                    <td style="color:black;font-weight: bold;background-color: #ec3633;opacity: 0.6; text-align: center; padding: 0.5rem">
                                        SIL 1
                                    </td>
                                {% elif maxi.1 > 0.001 %}
                                    <td style="color:black;font-weight: bold;background-color: orange;opacity: 0.6; text-align: center; padding: 0.5rem">
                                        SIL 2
                                    </td>
                                {% else %}
                                    <td style="color:black;font-weight: bold; background-color:  lime;opacity: 0.6; text-align: center; padding: 0.5rem">
                                        Under Sil2
                                    </td>

                                {% endif %}
                            </tr>

                            </tbody>

                        </table>
                    </div>


                </div>
            </div>

            <div class="row">
                <div class="col-6">

                    <div id="container3"></div>
                    <p>
                        <a class="btn btn-secondary" style="float: right; color: white" role="button"
                           onclick="showresults3()">View Max and Averages &#8650; </a></p>
                    <div id="result3" ; style="display: none;">
                        <div style="width: 45%;float:right;">


                            <table class="table thead-dark table-striped "
                                   style="border:1px solid black; background-color: #FFFFFF">
                                <thead class="thead-dark">
                                <h6 class="text-light bg-dark" style="text-align: center; padding: 0.5rem">Average Value
                                    Analysis</h6>
                                <tr>

                                    <th scope="col text-light"> Average PFD</th>
                                    <th scope="col text-light"> Sil/Condition</th>
                                </tr>
                                </thead>

                                <tbody>

                                <tr>

                                    <td scope="col"> {{ average.2 | stringformat:".2e" }} </td>
                                    {% if average.2  > 0.01 %}
                                        <td style="color:black;font-weight: bold;background-color: #ec3633;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            SIL 1
                                        </td>
                                    {% elif average.2 > 0.001 %}
                                        <td style="color:black;font-weight: bold;background-color: orange;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            SIL 2
                                        </td>
                                    {% else %}
                                        <td style="color:black;font-weight: bold; background-color:  lime;opacity: 0.6; text-align: center; padding: 0.5rem">
                                            Under Sil2
                                        </td>

                                    {% endif %}
                                </tr>

                                </tbody>

                            </table>
                        </div>
                        <table class="table thead-dark table-striped "
                               style="width: 45%;border:1px solid black; background-color: #FFFFFF">
                            <thead class="thead-dark">
                            <h6 class="text-light bg-dark" style="width: 45%;text-align: center; padding: 0.5rem">Maximo
                                Value Analysis</h6>
                            <tr>

                                <th scope="col text-light"> Maximo PFD</th>
                                <th scope="col text-light"> Sil/Condition</th>
                            </tr>
                            </thead>

                            <tbody>

                            <tr>

                                <td scope="col"> {{ maxi.2 | stringformat:".2e" }} </td>
                                {% if maxi.2  > 0.01 %}
                                    <td style="color:black;font-weight: bold;background-color: #ec3633;opacity: 0.6; text-align: center; padding: 0.5rem">
                                        SIL 1
                                    </td>
                                {% elif maxi.2 > 0.001 %}
                                    <td style="color:black;font-weight: bold;background-color: orange;opacity: 0.6; text-align: center; padding: 0.5rem">
                                        SIL 2
                                    </td>
                                {% else %}
                                    <td style="color:black;font-weight: bold; background-color:  lime;opacity: 0.6; text-align: center; padding: 0.5rem">
                                        Under Sil2
                                    </td>

                                {% endif %}
                            </tr>

                            </tbody>

                        </table>
                    </div>


                </div>
                <div class="col-6">


                </div>

            </div>
        </div>

    </div>
    <!-- main -->

    {% block script %}
        <script>
            {% for data in data_to_charts %}
                Highcharts.stockChart('container{{ forloop.counter }}', {


                    chart: {
                        type: 'area',
                        height: '450',
                    },

                    rangeSelector: {

                        buttons: [
                            {
                                type: 'all',
                                text: 'Op. Limit',

                            },
                            {
                                type: 'year',
                                count: 1,
                                text: '1y'
                            }, {
                                type: 'all',
                                text: 'All'
                            }
                        ],
                        buttonTheme: {
                            width: 60
                        },
                    },
                    title: {
                        text: `{{ data.desc | safe }}`

                    },


                    yAxis: {


                        type: 'logarithmic',
                        min: 0.000001,
                        max: 0.5,

                        labels: {
                            formatter: function () {
                                return this.value.toExponential(1);
                            }
                        },

                        plotLines: [

                            {value: {{0.01}}, width: 1, color: 'red', dashStyle: 'ShortDash', label: {text: "SIL 1"}},
                            {
                                value: {{0.001}},
                                width: 1,
                                color: 'orange',
                                dashStyle: 'ShortDash',
                                label: {text: "SIL 2"}
                            },
                            {value: {{0.0001}}, width: 1, dashStyle: 'ShortDash', label: {text: "SIL 3"}},

                        ]
                    },

                    xAxis: {

                        type: 'datetime',
                        dateTimeLabelFormats: { // don't display the dummy year
                            month: '%e. %b',

                        },


                        accessibility: {
                            rangeDescription: 'operational days'
                        }
                    },

                    legend: {
                        enabled: true,
                        align: 'left'
                    },


                    plotOptions: {



                        series: {


                            pointStart: Date.UTC({{campaign.start_date.year}}, {{campaign.start_date.month}} -1, {{campaign.start_date.day}}), // start date
                            pointInterval: 3600 * 1000 // one hour in miliseconds
                        }
                    },

                    series: [{
                        color: '#337ab7',
                        name: 'Normal',
                        tooltip: {},
                        dashStyle: 'shortdash',
                        data: {{data.result | safe}},


                    },



                    ],


                    responsive: {
                        rules: [{
                            condition: {
                                maxWidth: 400
                            },
                            chartOptions: {
                                legend: {
                                    layout: 'horizontal',
                                    align: 'center',
                                    verticalAlign: 'bottom'
                                }
                            }
                        }]


                    }


                });
            {% endfor %}
        </script>
    {% endblock %}

    {% block script2 %}
        <script>

            function showresults1() {
                var x = document.getElementById("result1");
                if (x.style.display === "none") {
                    x.style.display = "block";
                } else {
                    x.style.display = "none";
                }
            }

            function showresults2() {
                var x = document.getElementById("result2");
                if (x.style.display === "none") {
                    x.style.display = "block";
                } else {
                    x.style.display = "none";
                }
            }

            function showresults3() {
                var x = document.getElementById("result3");
                if (x.style.display === "none") {
                    x.style.display = "block";
                } else {
                    x.style.display = "none";
                }
            }

            function showresults4() {
                var x = document.getElementById("result4");
                if (x.style.display === "none") {
                    x.style.display = "block";
                } else {
                    x.style.display = "none";
                }
            }

            function showresults5() {
                var x = document.getElementById("result5");
                if (x.style.display === "none") {
                    x.style.display = "block";
                } else {
                    x.style.display = "none";
                }
            }

            function showresults6() {
                var x = document.getElementById("result6");
                if (x.style.display === "none") {
                    x.style.display = "block";
                } else {
                    x.style.display = "none";
                }
            }

        </script>
    {% endblock %}
{% endblock %}
    </div>
